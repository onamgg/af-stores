<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AF Stores</title>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 0;
  text-align: center;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-color: #eaeaea;
  transition: 0.4s;
}

h1 {
  background: #222;
  color: white;
  padding: 15px;
  margin: 0;
}

#categories button {
  padding: 10px 20px;
  margin: 10px;
  font-size: 16px;
  cursor: pointer;
}

#products {
  display: none;
  margin-top: 20px;
  flex-wrap: wrap;
  justify-content: center;
}

.product {
  border: 1px solid #ccc;
  margin: 15px;
  padding: 10px;
  width: 220px;
  background: rgba(255,255,255,0.95);
  border-radius: 8px;
  display: inline-block;
}

.product img {
  width: 100%;
  height: 130px;
  object-fit: cover;
}

/* Cart Button */
#cartButton {
  position: fixed;
  top: 15px;
  right: 15px;
  background: green;
  color: white;
  padding: 10px 15px;
  cursor: pointer;
  border-radius: 5px;
  z-index: 1000;
}

/* Cart Panel */
#cart {
  position: fixed;
  right: -320px;
  top: 0;
  width: 300px;
  height: 100%;
  background: #f4f4f4;
  border-left: 2px solid #ccc;
  padding: 10px;
  overflow-y: auto;
  transition: 0.3s;
}

#cart.show {
  right: 0;
}

.checkout-btn {
  background: green;
  color: white;
  padding: 10px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  margin-top: 10px;
}
</style>
</head>

<body>

<h1>AF Stores</h1>

<div id="cartButton" onclick="toggleCart()">ðŸ›’ Cart</div>

<div id="categories">
  <button onclick="showCategory('vegetable')">Vegetables</button>
  <button onclick="showCategory('stationary')">Stationary</button>
  <button onclick="showCategory('bakery')">Bakery</button>
</div>

<div id="products"></div>

<div id="cart">
  <h2>Your Cart</h2>
  <ul id="cartList"></ul>
  <p id="total">Total: â‚¹0</p>
  <button onclick="checkout()" class="checkout-btn">Checkout</button>
</div>

<script>
let cart = [];
let currentProducts = [];

// fetch products from JSON
async function loadProducts() {
  const response = await fetch("products.json");
  return await response.json();
}

// show products by category
async function showCategory(category){
  const products = await loadProducts();
  const productsDiv = document.getElementById("products");
  productsDiv.innerHTML = "";
  productsDiv.style.display = "block";

  currentProducts = products.filter(item => item.category === category);

  currentProducts.forEach((item, index) => {
    productsDiv.innerHTML += `
      <div class="product">
        <img src="${item.image}">
        <h3>${item.name}</h3>
        <p>Price: â‚¹${item.price}</p>
        <p>Stock: ${item.stock}</p>
        <button onclick="addToCart(${index})">Add to Cart</button>
      </div>
    `;
  });
}

function addToCart(index){
  const item = currentProducts[index];
  if(item.stock <= 0){
    alert("Out of Stock");
    return;
  }
  item.stock -= 1;
  cart.push(item);
  updateCart();
  showCategory(item.category); // refresh stock display
}

function updateCart(){
  const cartList = document.getElementById("cartList");
  const total = document.getElementById("total");
  cartList.innerHTML = "";
  let sum = 0;
  cart.forEach(item => {
    sum += item.price;
    cartList.innerHTML += `<li>${item.name} - â‚¹${item.price}</li>`;
  });
  total.innerText = "Total: â‚¹" + sum;
}

function toggleCart(){
  document.getElementById("cart").classList.toggle("show");
}

function checkout(){
  if(cart.length === 0){
    alert("Your cart is empty!");
    return;
  }
  cart = [];
  updateCart();
  alert("Thanks for shopping!");
}
</script>
</body>
</html>
